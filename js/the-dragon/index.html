<!doctype html>
<html>
<head>
  <title>l-systems</title>
  <script src="processing.js" type="text/javascript"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script src='rulesets.js'></script>
  <script>
    // fullscreen canvas from Anthony Mattox: http://anthonymattox.com/full-browser-processing-js
    var processingInstance;
    function loadInstance() {
      processingInstance = processingInstance || Processing.getInstanceById('pCanvas');
    }

    function resizeWindow() {
      loadInstance();
      processingInstance.resize($(window).width(), $(window).height());

      var rule = window[ $('#rules .selected').data('ruleset') ];

      // modify the page
      $("#header h1").text(rule.title);
      $("#header h1").css({'text-shadow': 'rgb(' + rule.color.r +','+ rule.color.g +','+ rule.color.b +') 0px 2px 2px'});

      processingInstance.init(rule);

      if ($('#header').is('.hidden')) $('#header').removeClass('hidden');
    }

    var ProcessingInit = function() {
      $(window).resize(resizeWindow);
      resizeWindow();
    }

    $(function () {
      $('#options').hover(function () { $('#rules').toggleClass('hidden') });
      $('#options li a').click(function (evt) {
        loadInstance();
        $('#rules a').removeClass('selected');
        $(evt.target).addClass('selected');
        resizeWindow();
      });
    });
  </script>
  <link href='reset.css' type='text/css' rel='stylesheet' />
  <style>
    body {
      font-family: Helvetica, Arial;
      -webkit-font-smoothing: antialiased;
      background: #141414;
    }

    #footer {
      margin: 0 0;
      z-index: 98;
      position: absolute;
      bottom: 10px;
      left: 10px;
    }
      #footer a {
        color: #ace;
      }

    #header {
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 100;
      margin: 0 0;
    }
    #header h1 {
      font: 64px Helvetica, Arial;
      color: #141414;
      text-shadow: rgb(68, 85, 102) 0px 2px 3px;
      line-height: 0.8em;
    }

    #pCanvas { position: absolute; top: 0; left: 0; }

    #options {
      opacity: 0.6;
      margin-top: 16px;
      border: 1px solid #fff;
      color: #fff;
      display: inline-block;
    }
    #options li { padding: 8px; }
    #options li strong { font-weight: bold; }

    #rules a { cursor: pointer; }
    #rules a:hover { text-decoration: underline; }
    #rules li { padding: 8px 0; }
    #rules li:first-child { margin-top: 1px; }

    .hidden { display: none; }

  </style>
</head>
<body>
  <div id='header' class='hidden'>
    <h1>L-SYSTEMS</h1>
    <ul id='options'>
      <li>
        <strong>RULES</strong>
        <ul id='rules' class='hidden'>
          <li><a data-ruleset='DRAGON_RULES' class='selected'>THE DRAGON CURVE</a></li>
          <li><a data-ruleset='TREE_RULES'>A SIMPLE TREE</a></li>
          <li><a data-ruleset='PLANT_RULES'>AN ORDINARY PLANT</a></li>
          <li><a data-ruleset='TRIANGLE_RULES'>THE SIERPINSKI TRIANGLE</a></li>
          <li><a data-ruleset='SNOWFLAKE_RULES'>THE KOCH SNOWFLAKE</a></li>
          <!-- <li><a data-ruleset='TILING_RULES'>A SIMPLE TILING</a></li> -->
        </ul>
      </li>
    </ul>
  </div>

  <canvas data-processing-sources="dragon.pde" id='pCanvas'></canvas>

  <div id='footer'>
    <a href='https://github.com/abachman/sketchbook/blob/master/js/the-dragon/dragon.pde' target='_blank'>get the code</a>
  </div>

  <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
    var pageTracker = _gat._getTracker("UA-3540787-1");
    pageTracker._initData();
    pageTracker._trackPageview();
  </script>
</body>
</html>
